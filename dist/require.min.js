/*!
 * require - v2.0.1 (2013-04-06)
 *
 * @author creasty
 * @url http://github.com/creasty/require
 * @copyright 2013 creasty
 */
(function(){"use strict";var e,t,n,r,i,a,u,s,o,l,c,p,f,d,h,g,m,v,y,k,x=[].slice;e=jQuery,k=this,c=k.document,g=k.localStorage,t=e("head"),s=[],o=0,f=/\bdefine\s*\(/,r=864e5,u={prefix:"require-",baseUrl:"",paths:{},injectors:{},shim:{},map:{},cache:!0,debug:!1,override:!1,expiration:30,interval:10,timeout:6e3},y={inject:function(e,t){var n,r;return"function"==typeof(n=u.injectors)[r=this.getFileExtension(e)]?n[r](t,e):void 0},getFileExtension:function(e){var t;return null!=(t=/(\w+)([\?#].+)?$/.exec(e.toLowerCase()))?t[1]:void 0},getPackageType:function(e){var t;return e.indexOf("!")>0?"plugin":e.match(/^(|\.\.|\~|https?:)\//)||u.injectors[null!=(t=/\w+$/.exec(e))?t[0]:void 0]?"path":"package"},getFullPackages:function(e,t){return new n(e,t).get()},doMap:function(e,t){var n,r,i;return null==t&&(t="*"),null!=(n=null!=(r=null!=(i=u.map[t])?i:u.map["*"])?r[e]:void 0)?n:e},fixBase:function(e,t){var n;return t?"."===e?t:"./"===e.slice(0,2)?u.injectors[null!=(n=/\w+$/.exec(e))?n[0]:void 0]?"~/"+t+"/"+e.slice(2):t+"/"+e.slice(2):e:e},regulateName:function(e,t){return this.fixBase(this.doMap(e,t),t)},trimDots:function(e){var t,n,r,i,a;for(n=[],a=e.split("/"),r=0,i=a.length;i>r;r++)t=a[r],".."===t&&0!==r?n.pop():"."!==t&&n.push(t);return n.join("/")},toUrl:function(e){return e=function(){switch(this.getPackageType(e)){case"path":return e.replace(/^\~\/((\w*)\/)?/,function(e,t,n){var r;return r=u.paths[n],u.baseUrl+"/"+(r?r+"/":null!=t?t:"")});case"package":return e=e.replace(/^\w+/,function(e){var t;return null!=(t=u.paths[e])?t:e}),u.baseUrl+"/"+e+".js";default:return e}}.call(this),this.trimDots(e)},sanitizeNamespace:function(e){return e.replace(/\//g,".").replace(/[^\w\.\$]+/g,"_").replace(/\b(\d+)/g,"_$1").replace(/\.+/g,".").replace(/^\.*(.+?)\.*$/,"$1")},useNamespace:function(e,t,n){var r,i,a,u,s,o;for(r=k,e=this.sanitizeNamespace(e),o=e.split("."),u=0,s=o.length;s>u;u++){if(a=o[u],null==r[a]){if(!t)return n;r[spaces]={}}i=r,r=r[a]}return n?i[a]=n:r},error:function(){throw Error(x.call(arguments).join(" "))},log:function(){return u.debug?console.log.apply(console,["[log]"].concat(x.call(arguments))):void 0}},n=function(){function t(e,t){this.packages=e,this.base=null!=t?t:"*",this.added={}}return t.prototype.checkAdded=function(e){return this.added[e]>>>=0,this.added[e]++},t.prototype.addDependencies=function(e,t){var n,r,i,a,s;for(i=t.split("/"),n=a=1,s=i.length;s>a;n=a+=1)r=i.slice(0,n).join("/"),this.added[r]||(u.shim[r]?(e.push.apply(e,this.expand([r])),this.checkAdded(r)):this.addSinglePackage(e,r));return e},t.prototype.addModulePackage=function(t,n,r){var i,a,s,o,l;if(i=u.shim[n]){if(this.checkAdded(n))return;return e.isArray(i)&&(i=u.shim[n]={deps:i}),"string"==typeof i.exports&&(l=u.shim[n].exports,u.shim[n].exports=function(){return y.useNamespace(l)}),i=e.extend({pkg:n,silent:r,deps:[],fallbacks:[]},i),s=-1,i.deps=function(){var e,r,l,c;for(l=i.deps,c=[],e=0,r=l.length;r>e;e++)o=l[e],o=y.regulateName(o,n),a=null!=i.fallbacks[++s]?(i.fallbacks[s]=y.regulateName(i.fallbacks[s],n),[i.fallbacks[s],y.toUrl(i.fallbacks[s])]):void 0,"package"===y.getPackageType(o)&&this.addDependencies(t,o),o!==n&&u.shim[o]?t.push.apply(t,this.expand([o])):c.push({name:o,uri:y.toUrl(o),fallback:a});return c}.call(this),t.push(i)}return this.addSinglePackage(t,n)},t.prototype.addSinglePackage=function(e,t){return this.checkAdded(t)?void 0:e.push({pkg:t,deps:[{name:t,uri:y.toUrl(y.regulateName(t,this.base))}]})},t.prototype.addPluginPackage=function(e,t){return this.checkAdded(t)?void 0:e.push({pkg:t,deps:[{name:t,func:t}]})},t.prototype.expand=function(e){var t,n,r,i,a,u;for(t=[],a=0,u=e.length;u>a;a++)n=e[a],(r="&"===n.charAt(0))&&(n=n.substr(1)),n=y.regulateName(n,this.base),i=y.getPackageType(n),"path"===i?this.addSinglePackage(t,n):"plugin"===i?this.addPluginPackage(t,n):(this.addDependencies(t,n),this.addModulePackage(t,n,r));return t},t.prototype.get=function(){return this.expand(this.packages)},t}(),a={set:function(e,t){var n;if(u.cache&&g){n=+new Date;try{g.setItem(u.prefix+e,n+t)}catch(r){}return y.log("Cached ",e)}},get:function(e){var t,n;if(u.cache&&g&&(t=g.getItem(u.prefix+e))&&(n=+t.slice(0,13),t=t.slice(13),!(+new Date>n+u.expiration*r)))return y.log("Loaded form cache",e),t},clear:function(){var e,t;if(g){t=[];for(e in g)e&&0===e.indexOf(u.prefix)&&t.push(g.removeItem(e));return t}}},p={exports:{},unwrap:function(t){var n,r,i,a,s,o;if(!t.pkg)return t.data;if(r=null!=(s=u.shim[t.pkg])?s:t,i=null!=(o=r.deps)?o:[],!e.isFunction(t.exports))return t.exports;n=function(){var e,n,r;for(r=[],e=0,n=i.length;n>e;e++)a=i[e],a=y.fixBase(y.regulateName(a),t.pkg),r.push(this.get((a===t.pkg?"#":"")+a));return r}.call(this);try{return t.exports=t.exports.apply(r,n)}catch(l){}},set:function(e){var t,n,r,i,a,u,s,o,l;return i=null!=(a=null!=(u=e.name)?u:e.pkg)?a:"",n=(e.name?"#":"")+i,r=y.getPackageType(i),(t=this.get(n))?void 0:("package"===r&&"string"==typeof e.exports&&(i=e.exports),this.exports[n]=null!=(s=this.unwrap(e))?s:{},"package"===r?this.exports[n]=null!=(o=y.useNamespace(i,!1,e.exports))?o:{}:"plugin"!==r&&e.pkg&&(this.exports[i]=null!=(l=this.get("#"+i))?l:{}),y.log("Exported",n))},get:function(e){return this.exports[e]},remove:function(e){return this.exports[e]=void 0}},h={status:{},getStatus:function(t,n){var r;return n?(r=e.Deferred(),this.status[t].then(function(){return r.resolve()},r.reject),r.promise()):this.status[t]},setStatus:function(e,t){return this.status[e]=t},getData:function(t,n,r,i){var l,c,p,d=this;return null==r&&(r={}),c=e.Deferred(),(l=a.get(n))?c.resolve({name:t,uri:n,data:l,inject:!0}):(p=y.getFileExtension(n),r=e.extend({url:n,timeout:u.timeout,cache:u.cache,dataType:"function"==typeof u.injectors[p]?"text":void 0},r),e.ajax(r).done(function(e){return y.log("Ajax loaded",n),a.set(n,e),"js"===p&&e.match(f)?(s[o]={name:t,dfd:c},y.inject(n,e.replace(f,"require.defineByQueue("+o++ +","))):c.resolve({name:t,uri:n,data:e,inject:!0})}).fail(function(r,a){return e.isArray(i)?d.getData.apply(d,i).then(c.resolve,c.reject):(c.reject(t,a),y.error("Ajax",a,n))})),c.promise()},invokeFunction:function(t,n){var r,a,s,o;return a=e.Deferred(),o=n.split("!"),s=o[0],r=o[1],new i([s]).then(function(){var e,n;return(e=null!=(n=u.shim[s])?n.plugin:void 0)?e(a,t,null!=r?r:""):a.resolve(t,"noplugin")},a.reject),a.done(function(e){return e?p.set(e):void 0}),a.promise()},loadPackage:function(t){var n,r,i,a,u;return a=function(){var e,a,s,o,l;for(s=t.deps,l=[],e=0,a=s.length;a>e;e++)o=s[e],i=o.name,u=o.uri,r=o.func,n=o.fallback,this.getStatus(i)?l.push(this.getStatus(i,!0)):r?l.push(this.setStatus(i,this.invokeFunction(i,r))):l.push(this.setStatus(i,this.getData(i,u,{},n)));return l}.call(this),e.when.apply(e,a)},load:function(t,n){var r,i,a,u,s=this;return i=y.getFullPackages(t,n),r=e.Deferred(),u=function(){var e,t,n;for(n=[],e=0,t=i.length;t>e;e++)a=i[e],this.getStatus(a.pkg)?n.push(this.getStatus(a.pkg,!0)):n.push(this.setStatus(a.pkg,this.loadPackage(a)));return n}.call(this),e.when.apply(e,u).done(function(){return s.finish(u,i,r.resolve)}).fail(r.reject),r.promise()},finish:function(e,t,n){var r,i=this;return(r=e.shift())?r.done(function(){var r,a,s,o,l,c;for(s=t.shift(),l=0,c=arguments.length;c>l;l++)o=arguments[l],o&&(o.inject&&y.inject(o.uri,o.data),o.name&&p.set(o));return p.set(s),r=function(){var e,t,n,r,i,o;for(i=null!=(n=null!=(r=u.shim[s.pkg])?r.deps:void 0)?n:[],o=[],e=0,t=i.length;t>e;e++)a=i[e],o.push(p.get(y.regulateName(a,s.pkg)));return o}(),"function"==typeof s.init&&s.init.apply(s,r),s.silent||"function"==typeof s.runs&&s.runs.apply(s,r),i.finish(e,t,n)}):n()}},i=function(){function t(e){this.modules=e,this.loader=h.load(this.modules)}return t.prototype._fn=function(){var e,t,n;return t=arguments[0],e=arguments.length>=2?x.call(arguments,1):[],(n=this.loader)[t].apply(n,e),this},t.prototype.require=function(t){var n,r,i,a,u,s,o,l;if(null!=t){if(e.isNumeric(t))t=this.modules[t];else if(!this.modules[t]){for(s=this.modules,n=0,i=s.length;i>n&&(u=s[n],!u.indexOf(t>=0));n++);t=u}return p.get(y.regulateName(t))}for(o=this.modules,l=[],r=0,a=o.length;a>r;r++)t=o[r],l.push(p.get(y.regulateName(t)));return l},t.prototype.done=function(e){var t=this;return this._fn("done",function(){return e.apply(t,t.require())})},t.prototype.fail=function(e){return this._fn("fail",e)},t.prototype.progress=function(e){return this._fn("progress",e)},t.prototype.always=function(e){return this._fn("always",e)},t.prototype.then=function(e,t,n){var r=this;return this._fn("then",function(){return e.apply(r,r.require())},t,n)},t}(),m=function(t,n,r){return e.isFunction(n)?new i(t).then(n,r):new i(arguments)},l=function(t,n,r,i){var a;return null==i&&(i=!1),null==t?u.shim:(a=e.isArray(n)&&null!=r?[n,r]:null!=n?[[],n]:void 0,n=a[0],r=a[1],!u.shim[t]||i||u.override?(v(t),u.shim[t]={deps:n,exports:r}):void 0)},v=function(e){var t;return t=y.regulateName(e),h.setStatus(t,null),p.remove(t),u.shim[e]=void 0},e.extend(m,y,{cache:a,exports:p,loader:h,main:function(){var t;return t=e("script[data-main]").eq(0),1===t.length?(t=y.toUrl(t.data("main")),h.getData("__main",t,{async:!1}).done(function(e){var t,n;return t=e.data,n=e.uri,y.inject(n,t)})):void 0},config:function(t){return e.isPlainObject(t)?(t.shim&&(t.shim=e.extend(u.shim,t.shim)),t.map&&(t.map=e.extend(u.map,t.map)),e.extend(u,t)):u},undef:v,define:l,defineByQueue:function(){var e,t,n;return t=arguments[0],e=arguments.length>=2?x.call(arguments,1):[],(n=s[t])?("string"!=typeof e[0]&&e.unshift(n.name),l.apply(null,x.call(e).concat([!0])),h.load([e[0]],n.name).then(n.dfd.resolve,n.dfd.reject),s[t]=void 0):void 0},injectors:function(t){return e.isPlainObject(t)?e.extend(u.injectors,t):u.injectors},map:function(t){return null!=t?e.extend(u.map,t):u.map},toUrl:function(e,t){return y.toUrl(y.regulateName(e,t))}}),d={},e(c).ready(function(){return d.ready=!0}),e(k).load(function(){return d.load=!0}),l("ready",function(){var t;return t=function(t){return d.ready?t():e(c).ready(t)},this.plugin=function(e,n){return t(function(){return e.resolve({pkg:n,exports:c})})},t}),l("load",function(){var t;return t=function(t){return d.load?t():e(k).load(t)},this.plugin=function(e,n){return t(function(){return e.resolve({pkg:n,exports:k})})},t}),l("jquery",function(){return e}),m.injectors({css:function(e,n){var r;return r=n.replace(/[^\/]*$/,""),e=e.replace(/url\(('|"|)(?!\/|(https?:)?\/\/)(.+?)\1\)/g,"url("+r+"$3)"),t.append("<style>"+e+"</style>"),y.log("Injected CSS",n)},js:function(t,n){return t=t.replace(/<\/script>/g,"<\\/script>"),e.globalEval(t),y.log("Injected JavaScript",n)},json:!0}),m.main(),k.require=m,k.define=l}).call(this);