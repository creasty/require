/*!
 * require - v2.0.0 (2013-03-31)
 *
 * @author creasty
 * @url http://github.com/creasty/require
 * @copyright 2013 creasty
 */
(function(){"use strict";var e,t,n,r,i,u,a,o,s,l,c,p,d,f,h,g,m,v,y,x,k=[].slice;e=jQuery,x=this,c=x.document,g=x.localStorage,t=e("head"),o=[],s=0,d=/\bdefine\s*\(/,r=864e5,a={prefix:"require-",base:"./",paths:{},modules:{},injectors:{},alts:[],maps:[],cache:!0,debug:!1,override:!1,expiration:30,interval:10,timeout:6e3},y={replace:function(e,t,n){return"string"==typeof t?e.split(t).join(n):e.replace(t,n)},doAlts:function(e){var t,n,r,i,u;for(n=this.getPackageType(e),u=a.alts,r=0,i=u.length;i>r;r++)t=u[r],t.type&&t.type!==n||(e=this.replace(e,t.pattern,t.to));return e},doMaps:function(e){var t,n,r,i,u;if(t=/^(\~([a-z_\$]\w*)\/|[a-z_\$]\w*)/i.exec(e))for(t=t[2]&&a.paths[t[2]]?t[2]:t[1],u=a.maps,r=0,i=u.length;i>r;r++)n=u[r],n.path&&n.path!==t||(e=this.replace(e,n.pattern,n.to));return e},inject:function(e,t){var n,r;return"function"==typeof(n=a.injectors)[r=this.getFileExtension(e)]?n[r](t,e):void 0},getFileExtension:function(e){var t;return null!=(t=/(\w+)([\?#].+)?$/.exec(e.toLowerCase()))?t[1]:void 0},sanitizeNamespace:function(e){return e.replace(/\//g,".").replace(/[^\w\.\$]+/g,"_").replace(/\b(\d+)/g,"_$1").replace(/\.+/g,".").replace(/^\.*(.+?)\.*$/,"$1")},getPackageType:function(e){var t;return e.indexOf("!")>0?"plugin":e.match(/^(\.\/|)/)&&!a.injectors[null!=(t=/\w+$/.exec(e))?t[0]:void 0]?"package":"path"},fixBase:function(e,t){var n;return"."===e?t:"./"===e.slice(0,2)?a.injectors[null!=(n=/\w+$/.exec(e))?n[0]:void 0]?"~/"+t+"/"+e.slice(2):t+"/"+e.slice(2):e},trimDots:function(e){var t,n,r,i,u;for(n=[],u=e.split("/"),r=0,i=u.length;i>r;r++)t=u[r],".."===t&&0!==r?n.pop():"."!==t&&n.push(t);return n.join("/")},toUri:function(e){return e=function(){switch(this.getPackageType(e)){case"path":return this.doMaps(e).replace(/^\~\/((\w*)\/)?/,function(e,t,n){var r;return r=a.paths[n],a.base+"/"+(r?r+"/":null!=t?t:"")});case"package":return e=this.doMaps(e).replace(/^\w+/,function(e){var t;return null!=(t=a.paths[e])?t:e}),a.base+"/"+e+".js";default:return e}}.call(this),this.trimDots(e)},getFullPackages:function(e){return new n(e).get()},useNamespace:function(e,t,n){var r,i,u,a,o,s;for(r=x,e=this.sanitizeNamespace(e),s=e.split("."),a=0,o=s.length;o>a;a++){if(u=s[a],null==r[u]){if(!t)return n;r[spaces]={}}i=r,r=r[u]}return n?i[u]=n:r},error:function(){throw Error(k.call(arguments).join(" "))},log:function(){return a.debug?console.log.apply(console,["[log]"].concat(k.call(arguments))):void 0}},n=function(){function t(e){this.packages=e,this.added={}}return t.prototype.checkAdded=function(e){return this.added[e]>>>=0,this.added[e]++},t.prototype.addDependencies=function(e,t){var n,r,i,u,o;for(i=t.split("/"),n=u=1,o=i.length;o>u;n=u+=1)r=i.slice(0,n).join("/"),this.added[r]||(a.modules[r]?(e.push.apply(e,this.expand([r])),this.checkAdded(r)):this.addSinglePackage(e,r));return e},t.prototype.addModulePackage=function(t,n,r){var i,u;if(i=a.modules[n]){if(this.checkAdded(n))return;return i=e.extend({pkg:n,silent:r,modules:[]},i),i.modules=function(){var e,r,o,s;for(o=i.modules,s=[],e=0,r=o.length;r>e;e++)u=o[e],u=y.doAlts(u),u=y.fixBase(u,n),"package"===y.getPackageType(u)&&this.addDependencies(t,u),u!==n&&a.modules[u]?t.push.apply(t,this.expand([u])):s.push({name:u,uri:y.toUri(u)});return s}.call(this),t.push(i)}return this.addSinglePackage(t,n)},t.prototype.addSinglePackage=function(e,t){return this.checkAdded(t)?void 0:e.push({pkg:t,modules:[{name:t,uri:y.toUri(t)}]})},t.prototype.addPluginPackage=function(e,t){return this.checkAdded(t)?void 0:e.push({pkg:t,modules:[{name:t,func:t}]})},t.prototype.expand=function(e){var t,n,r,i,u,a;for(t=[],u=0,a=e.length;a>u;u++)n=e[u],(r="&"===n.charAt(0))&&(n=n.substr(1)),n=y.doAlts(n),i=y.getPackageType(n),"path"===i?this.addSinglePackage(t,n):"plugin"===i?this.addPluginPackage(t,n):(this.addDependencies(t,n),this.addModulePackage(t,n,r));return t},t.prototype.get=function(){return this.expand(this.packages)},t}(),u={set:function(e,t){var n;if(a.cache&&g){n=+new Date;try{g.setItem(a.prefix+e,n+t)}catch(r){}return y.log("Cached ",e)}},get:function(e){var t,n;if(a.cache&&g&&(t=g.getItem(a.prefix+e))&&(n=+t.slice(0,13),t=t.slice(13),!(+new Date>n+a.expiration*r)))return y.log("Loaded form cache",e),t},remove:function(e){return g?g.removeItem(a.prefix+y.toUri(y.doAlts(e))):void 0},clear:function(){var e,t;if(g){t=[];for(e in g)e&&0===e.indexOf(a.prefix)&&t.push(g.removeItem(e));return t}}},p={exports:{},unwrap:function(t){var n,r,i,u,o,s;if(!t.pkg)return t.data;if(r=null!=(o=a.modules[t.pkg])?o:t,i=null!=(s=r.modules)?s:[],!e.isFunction(t.exports))return t.exports;n=function(){var e,n,r;for(r=[],e=0,n=i.length;n>e;e++)u=i[e],u=y.fixBase(y.doAlts(u),t.pkg),r.push(this.get((u===t.pkg?"#":"")+u));return r}.call(this);try{return t.exports=t.exports.apply(r,n)}catch(l){}},set:function(e){var t,n,r,i,u,a,o,s;return i=null!=(u=e.name)?u:e.pkg,n=(e.name?"#":"")+i,r=y.getPackageType(i),(t=this.get(n))?void 0:(this.exports[n]=null!=(a=this.unwrap(e))?a:{},"package"===r?this.exports[n]=null!=(o=y.useNamespace(i,!1,e.exports))?o:{}:"plugin"!==r&&e.pkg&&(this.exports[i]=null!=(s=this.get("#"+i))?s:{}),y.log("Exported",n))},get:function(e,t){var n,r,i;if(null==t&&(t=!1),this.exports[e])return this.exports[e];if(t){i=this.exports;for(n in i){if(r=i[n],n.indexOf(0===e))break;r=null}return r}},remove:function(e){return this.exports[e]=void 0}},h={status:{},getStatus:function(t,n){var r;return n?(r=e.Deferred(),this.status[t].then(function(){return r.resolve()},r.reject),r.promise()):this.status[t]},setStatus:function(e,t){return this.status[e]=t},getData:function(t,n,r){var i,l,c;return null==r&&(r={}),l=e.Deferred(),(i=u.get(n))?l.resolve({name:t,uri:n,data:i,inject:!0}):(c=y.getFileExtension(n),r=e.extend({url:n,timeout:a.timeout,cache:a.cache,dataType:"function"==typeof a.injectors[c]?"text":void 0},r),e.ajax(r).done(function(e){return y.log("Ajax loaded",n),u.set(n,e),"js"===c&&e.match(d)?(o[s]={name:t,dfd:l},y.inject(n,e.replace(d,"require.defineByQueue("+s++ +","))):l.resolve({name:t,uri:n,data:e,inject:!0})}).fail(function(e,r){return l.reject(t,r),y.error("Ajax",r,n)})),l.promise()},invokeFunction:function(t,n){var r,u,o,s;return u=e.Deferred(),s=n.split("!"),o=s[0],r=s[1],new i([o]).then(function(){var e,n;return(e=null!=(n=a.modules[o])?n.plugin:void 0)?e(u,t,null!=r?r:""):u.resolve(t,"noplugin")},u.reject),u.done(function(e){return e?p.set(e):void 0}),u.promise()},loadPackage:function(t){var n,r,i,u;return i=function(){var e,i,a,o,s;for(a=t.modules,s=[],e=0,i=a.length;i>e;e++)o=a[e],r=o.name,u=o.uri,n=o.func,this.getStatus(r)?s.push(this.getStatus(r,!0)):n?s.push(this.setStatus(r,this.invokeFunction(r,n))):s.push(this.setStatus(r,this.getData(r,u)));return s}.call(this),e.when.apply(e,i)},load:function(t){var n,r,i,u,a=this;return r=y.getFullPackages(t),n=e.Deferred(),u=function(){var e,t,n;for(n=[],e=0,t=r.length;t>e;e++)i=r[e],this.getStatus(i.pkg)?n.push(this.getStatus(i.pkg,!0)):n.push(this.setStatus(i.pkg,this.loadPackage(i)));return n}.call(this),e.when.apply(e,u).done(function(){return a.finish(u,r,n.resolve)}).fail(n.reject),n.promise()},finish:function(e,t,n){var r,i=this;return(r=e.shift())?r.done(function(){var r,u,o,s,l,c;for(o=t.shift(),l=0,c=arguments.length;c>l;l++)s=arguments[l],s&&(s.inject&&y.inject(s.uri,s.data),s.name&&p.set(s));return p.set(o),r=function(){var e,t,n,r,i,s;for(i=null!=(n=null!=(r=a.modules[o.pkg])?r.modules:void 0)?n:[],s=[],e=0,t=i.length;t>e;e++)u=i[e],s.push(p.get(y.fixBase(y.doAlts(u),o.pkg)));return s}(),"function"==typeof o.init&&o.init.apply(o,r),o.silent||"function"==typeof o.runs&&o.runs.apply(o,r),i.finish(e,t,n)}):n()}},i=function(){function t(e){this.modules=e,this.loader=h.load(this.modules)}return t.prototype._fn=function(){var e,t,n;return t=arguments[0],e=arguments.length>=2?k.call(arguments,1):[],(n=this.loader)[t].apply(n,e),this},t.prototype.get=function(t){var n,r,i,u;if(null==t&&(t=!1),t!==!1)return e.isNumeric(t)&&(t=this.modules[t]),p.get(y.doAlts(t),!0);for(i=this.modules,u=[],n=0,r=i.length;r>n;n++)t=i[n],u.push(p.get(y.doAlts(t)));return u},t.prototype.done=function(e){var t=this;return this._fn("done",function(){return e.apply(t,t.get())})},t.prototype.fail=function(e){return this._fn("fail",e)},t.prototype.progress=function(e){return this._fn("progress",e)},t.prototype.always=function(e){return this._fn("always",e)},t.prototype.then=function(e,t,n){var r=this;return this._fn("then",function(){return e.apply(r,r.get())},t,n)},t}(),m=function(t,n,r){return e.isFunction(n)?new i(t).then(n,r):new i(arguments)},l=function(t,n,r,i){var u;return null==i&&(i=!1),null==t?a.modules:(u=e.isArray(n)&&null!=r?[n,r]:null!=n?[[],n]:void 0,n=u[0],r=u[1],!a.modules[t]||i||a.override?(v(t),a.modules[t]={modules:n,exports:r}):void 0)},v=function(e){var t;return t=y.doAlts(e),h.setStatus(t,null),p.remove(t),a.modules[e]=void 0},e.extend(m,y,{cache:u,exports:p,loader:h,main:function(){var t;return t=e("script[data-main]").eq(0),1===t.length?(t=y.toUri(t.data("main")),h.getData("__main",t,{async:!1}).done(function(e){var t,n;return t=e.data,n=e.uri,y.inject(n,t)})):void 0},config:function(t){return e.isPlainObject(t)?(t.modules&&(t.modules=e.extend(a.modules,t.modules)),t.alts&&(t.alts=e.extend(a.alts,t.alts)),t.maps&&(t.maps=e.extend(a.maps,t.maps)),e.extend(a,t)):a},undef:v,define:l,defineByQueue:function(){var e,t,n;return t=arguments[0],e=arguments.length>=2?k.call(arguments,1):[],(n=o[t])?("string"!=typeof e[0]&&e.unshift(n.name),l.apply(null,k.call(e).concat([!0])),n&&h.load([e[0]]).then(n.dfd.resolve,n.dfd.reject),o[t]=void 0,!0):!1},injectors:function(t){return e.isPlainObject(t)?e.extend(a.injectors,t):a.injectors},alts:function(t){return t?e.extend(a.alts,arguments):a.alts},maps:function(t){return t?e.extend(a.maps,arguments):a.maps},toUri:function(e){return y.toUri(y.doAlts(null!=e?e:""))}}),f={},e(c).ready(function(){return f.ready=!0}),e(x).load(function(){return f.load=!0}),l("jquery",function(){return e}),l("ready",function(){var t;return t=function(t){return f.ready?t():e(c).ready(t)},this.plugin=function(e,n){return t(function(){return e.resolve({pkg:n,exports:c})})},t}),l("load",function(){var t;return t=function(t){return f.load?t():e(x).load(t)},this.plugin=function(e,n){return t(function(){return e.resolve({pkg:n,exports:x})})},t}),m.injectors({css:function(e,n){var r;return r=n.replace(/[^\/]*$/,""),e=e.replace(/url\(('|"|)(?!\/|(https?:)?\/\/)(.+?)\1\)/g,"url("+r+"$3)"),t.append("<style>"+e+"</style>"),y.log("Injected CSS",n)},js:function(t,n){return t=t.replace(/<\/script>/g,"<\\/script>"),e.globalEval(t),y.log("Injected JavaScript",n)},json:!0}),m.main(),x.require=m,x.define=l}).call(this);